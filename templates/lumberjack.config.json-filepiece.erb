<%-
fields = @fields

if fields
  fields.each_pair do |k,v|
    if v.is_a? Array
    fields[k] = v.join(' ')
  end

  extra_fields = fields.map { |k,v| '"' + k + '": "' + v + '"'}.join(",")
else
  extra_fields = ''
end
-%>
    {
      "paths": [ 
        <%= @files.map {|f| '"' + f + '"'}.join(',') %>
      ],
      "fields": { <%= extra_fields %> }
    }
